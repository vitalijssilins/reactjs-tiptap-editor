"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("./index-CSvnpArE.cjs"),g=require("./index-CWKNKm3Y.cjs"),a=require("react/jsx-runtime"),L=require("react"),x=require("./ActionButton-DY0olRIe.cjs"),T=require("./index-BObJ0_Vs.cjs"),h=require("./dropdown-menu-Hk-jMIb6.cjs"),_=require("./Icon-R3ihBJhB.cjs");function E(e){return Number.parseFloat(e.replace("%",""))/100}function I(e){const{t}=T.useLocale(),[n,s]=L.useState("default");function o(i){i==="default"?e.editor.commands.unsetLineHeight():e.editor.commands.setLineHeight(i),s(i)}const u=L.useMemo(()=>{const r=e.editor.extensionManager.extensions.find(l=>l.name==="lineHeight").options.lineHeights.map(l=>({label:E(l),value:l}));return r.unshift({label:t("editor.default"),value:"default"}),r},[e]);return a.jsxs(h.DropdownMenu,{children:[a.jsx(h.DropdownMenuTrigger,{asChild:!0,disabled:e==null?void 0:e.disabled,children:a.jsx(x.ActionButton,{customClass:"!richtext-w-12 richtext-h-12",disabled:e==null?void 0:e.disabled,icon:"LineHeight",tooltip:e==null?void 0:e.tooltip,children:a.jsx(_.IconComponent,{className:"richtext-ml-1 richtext-size-3 richtext-text-zinc-500",name:"MenuDown"})})}),a.jsx(h.DropdownMenuContent,{className:"richtext-min-w-24",children:u==null?void 0:u.map((i,d)=>a.jsx(h.DropdownMenuCheckboxItem,{checked:i.value===n,onClick:()=>o(i.value),children:i.label},`lineHeight-${d}`))})]})}const b=["paragraph","heading","list_item","todo_item"];function D(e,t){const{selection:n,doc:s}=e;if(!n||!s||!(n instanceof m.TextSelection||n instanceof m.AllSelection))return e;const{from:o,to:u}=n,i=[],d=t&&t!==g.DEFAULT_LINE_HEIGHT?t:null;if(s.nodesBetween(o,u,(r,l)=>{const c=r.type;return b.includes(c.name)?((r.attrs.lineHeight||null)!==d&&i.push({node:r,pos:l,nodeType:c}),c.name!=="list_item"&&c.name!=="todo_item"):!0}),i.length===0)return e;for(const r of i){const{node:l,pos:c,nodeType:f}=r;let{attrs:H}=l;H={...H,lineHeight:d},e=e.setNodeMarkup(c,f,H,l.marks)}return e}function M(e){return({state:t,dispatch:n})=>{const{selection:s}=t;let{tr:o}=t;return o=o.setSelection(s),o=D(o,e),o.docChanged?(n&&n(o),!0):!1}}const A=m.Extension.create({name:"lineHeight",addOptions(){var e;return{...(e=this.parent)==null?void 0:e.call(this),types:["paragraph","heading","list_item","todo_item"],lineHeights:g.DEFAULT_LINE_HEIGHT_LIST,defaultHeight:g.DEFAULT_LINE_HEIGHT,button({editor:t,t:n}){return{component:I,componentProps:{editor:t,tooltip:n("editor.lineheight.tooltip")}}}}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:e=>e.style.lineHeight||this.options.defaultHeight,renderHTML:e=>e.lineHeight===this.options.defaultHeight||!e.lineHeight?{}:{style:`line-height: ${e.lineHeight}`}}}}]},addCommands(){return{setLineHeight:e=>M(e),unsetLineHeight:()=>({commands:e})=>this.options.types.every(t=>e.resetAttributes(t,"lineHeight"))}}});exports.DEFAULT_LINE_HEIGHT_LIST=g.DEFAULT_LINE_HEIGHT_LIST;exports.LineHeight=A;
